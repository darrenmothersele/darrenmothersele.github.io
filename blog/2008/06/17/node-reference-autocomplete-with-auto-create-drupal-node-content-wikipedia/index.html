<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title> Node Reference Autocomplete with Auto-create Drupal node content from Wikipedia |  Darren Mothersele</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <link rel="alternate" type="application/rss+xml" title="Darren Mothersele" href="http://www.darrenmothersele.com/rss.xml">
    
    <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>

<header id="header">
    <a href="/" class="image avatar"><img src="/img/darren100.jpg" alt="" /></a>
    <h1>
       <strong>Darren Mothersele</strong> </h1><h1> Creative Technologist
    </h1>

<ul class="menu-list">
    <li><a href="/about/">About me</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/contact/">Contact</a></li>
</ul>

</header>


<div id="main">
<div class="page">
  <header class="post-header">
<h2 class="post-title">Node Reference Autocomplete with Auto-create Drupal node content from Wikipedia</h2>

  <p class="">17 Jun 2008</p>

  </header>


            
              <p class="lead">Here's a few bits of code from today's Drupal wranglings that solves a tricky UX problem with Drupal and CCK Node Reference fields. </p>

              
<p>Ever wanted to deal with the case that a user might want to reference a node that doesn't exist yet? Well I've played around with a couple of modules (<a href="http://drupal.org/project/add_n_reference" rel="nofollow">Add n Reference</a> and <a href="http://drupal.org/project/addnode" rel="nofollow">Add Node</a>), but they didn't offer the clean user experience I needed. Here's an example use-case:</p>

<p>When creating a node of type gig, the user needs to enter artists that are playing. These artists are linked via node referrence fields in the data model. The select list widget is no good, because there will be thousands of possible artists. The autocomplete widget is better, but (a) requires that the artist node already exists, and (b) appends a string with the nid (node ID) to the end of the users input (which from user feedback they find confusing).</p>

<p>I've adapted the node reference widget to solve both of these issues:</p>

<p>(a) it allows the user to reference a node that doesn't exists. In this case it creates a new node with the body text taken from the first matching Wikipedia entry. The idea is that this is just seed content, and the user will eventually update the content for themselves. </p>

<p>(b) i removed the nid requirement from the autocomplete callback.</p>

<p>There are some major improvements to make soon, but this will work for the time being. Eventually I want to give the user options to "disambiguate" the response - for example: if multiple possible matches are found then show a drop down select, and use the MediaWiki API to pull content from Wikipedia, giving the user option to select from a few similar articles if the correct article is not obvious.</p>

<p>Check out the attached file for the basics of the module. This is just a preview, as there's some domain specific code still in there (e.g. I also import artist images from Wikipedia). This will be made more universal when I produce the final version of the module, but you may need to comment this out for now.</p>

            

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'darrenmothersele';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>







<div class="h-card">

  <a class="p-name u-url" href="http://www.darrenmothersele.com">Darren Mothersele</a>
    <i class="icon">&#128681;</i>
    <span class="p-locality">London</span>, <span class="p-country-name">UK</span>
    <br>
    <i class="icon">&#9993;</i>
  <a class="u-email" href="mailto:darren@darrenmothersele.com">darren@darrenmothersele.com</a>
  <p class="p-note">Creative Technologist</p>

    <img class="u-photo" src="/img/darren100.jpg" alt="" width="40px" />
</div>

<div class="my-tinyletter">
    <h4>Updates...</h4>
<form action="https://tinyletter.com/dazm" method="post">
    <p>
        <label for="tlemail">To get my monthly 'friends and family' newsletter, enter your email address:</label>
    </p>
    <p>
        <input type="text" name="email" id="tlemail" placeholder="Email" /><br>
        <input type="hidden" value="1" name="embed"/>
        <input type="submit" value="Subscribe" /><br>
        <a href="https://tinyletter.com" target="_blank" style="font-size:75%;">
            powered by TinyLetter
        </a>
    </p>
</form>

<p><a href="/indieweb">Am I Indie Yet?</a> <br>
<a href="https://github.com/darrenmothersele/ama">Ask me anything!</a> <br>
No tracking is used on this site.</p>

</div>



</div>
</div>

<footer id="footer">
    <ul class="icons">
        <li><a href="https://twitter.com/mothersele" rel="me" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
        <li><a href="https://github.com/darrenmothersele" rel="me" class="icon fa-github"><span class="label">Github</span></a></li>
        <li><a href="mailto:darren@darrenmothersele.com" class="icon fa-envelope-o"><span class="label">
    <script type="text/javascript">
    var data = "&#100;&#97;&#114;&#114;&#101;&#110;&#64;&#100;&#97;&#114;"
    + "&#114;&#101;&#110;&#109;&#111;&#116;&#104;&#101;&#114;&#115;&#101;"
    + "&#108;&#101;&#46;&#99;&#111;&#109;";
    document.write(data);
    </script></span></a></li>
    </ul>
    <ul class="copyright">
        <li>
        &copy;2007-2016 Darren Mothersele.
        Unless specified otherwise, content is licensed under a
        <a class="text-white" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative
            Commons Attribution-ShareAlike 3.0 Unported License</a>.</li>
    </ul>
</footer>

</body>
</html>
