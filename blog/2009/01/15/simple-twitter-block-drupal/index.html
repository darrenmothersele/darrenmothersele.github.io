<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Simple Twitter Block for Drupal | Darren Mothersele</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>

<div class="home-logo">
  <a href="/">
<img src="/img/daz-logo.png" alt="Daz Logo" class="home-logo-img">
</a>
</div>

<hgroup class="alignCenter">
  <h1>Simple Twitter Block for Drupal</h1>
        <h6>Jan 15, 2009 · By Darren Mothersele</h6>
  <p class="sc">web-dev</p>
</hgroup>
<p>Here's a quick way to add recent tweets to your Drupal powered websites. The following code is as simple as possible. Add it to your site's module folder and enable the module. You they get a block to position on your site. The block is populated with your most recent tweets via a Javascript call to the Twitter website.</p>

<!--break-->
<p>First thing to do is create the module info file so Drupal can find your module. I'm going to call the module tweetblock - but you can change this if you like. I put the following code in a file called "tweetblock.info"</p>
<p></p><div class="codeblock"><code>name = Twitter Block<br />core = 6.x<br />package = Other</code></div>
<p>Then I create the main module in a file called "tweetblock.module" with the following code:</p>
<p></p><div class="codeblock"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">function </span><span style="color: #0000BB">tweetblock_block</span><span style="color: #007700">(</span><span style="color: #0000BB">$op </span><span style="color: #007700">= </span><span style="color: #DD0000">'list'</span><span style="color: #007700">, </span><span style="color: #0000BB">$delta </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #0000BB">$edit </span><span style="color: #007700">= array()) { <br />  if (</span><span style="color: #0000BB">$op </span><span style="color: #007700">== </span><span style="color: #DD0000">'list'</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$blocks</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">] = array(<br />      </span><span style="color: #DD0000">'info' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'Twitter'</span><span style="color: #007700">),<br />    );<br />    return </span><span style="color: #0000BB">$blocks</span><span style="color: #007700">;<br />  }<br />  if (</span><span style="color: #0000BB">$op </span><span style="color: #007700">== </span><span style="color: #DD0000">'configure' </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$delta </span><span style="color: #007700">== </span><span style="color: #0000BB">0</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$form</span><span style="color: #007700">[</span><span style="color: #DD0000">'tweetblock_username'</span><span style="color: #007700">] = array(<br />      </span><span style="color: #DD0000">'#type' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'textfield'</span><span style="color: #007700">,<br />      </span><span style="color: #DD0000">'#title' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'Twitter Username'</span><span style="color: #007700">),<br />      </span><span style="color: #DD0000">'#default_value' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">variable_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'tweetblock_username'</span><span style="color: #007700">, </span><span style="color: #DD0000">'mothersele'</span><span style="color: #007700">),<br />    );<br />    </span><span style="color: #0000BB">$form</span><span style="color: #007700">[</span><span style="color: #DD0000">'tweetblock_count'</span><span style="color: #007700">] = array(<br />      </span><span style="color: #DD0000">'#type' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'textfield'</span><span style="color: #007700">,<br />      </span><span style="color: #DD0000">'#title' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'Number of items'</span><span style="color: #007700">),<br />      </span><span style="color: #DD0000">'#default_value' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">variable_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'tweetblock_count'</span><span style="color: #007700">, </span><span style="color: #0000BB">6</span><span style="color: #007700">),<br />    );<br />    return </span><span style="color: #0000BB">$form</span><span style="color: #007700">; <br />  } <br />  if (</span><span style="color: #0000BB">$op </span><span style="color: #007700">== </span><span style="color: #DD0000">'save' </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$delta </span><span style="color: #007700">== </span><span style="color: #0000BB">0</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">variable_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'tweetblock_username'</span><span style="color: #007700">, </span><span style="color: #0000BB">$edit</span><span style="color: #007700">[</span><span style="color: #DD0000">'tweetblock_username'</span><span style="color: #007700">]);<br />    </span><span style="color: #0000BB">variable_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'tweetblock_count'</span><span style="color: #007700">, </span><span style="color: #0000BB">$edit</span><span style="color: #007700">[</span><span style="color: #DD0000">'tweetblock_count'</span><span style="color: #007700">]);<br />  }<br />  if (</span><span style="color: #0000BB">$op </span><span style="color: #007700">== </span><span style="color: #DD0000">'view' </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$delta </span><span style="color: #007700">== </span><span style="color: #0000BB">0</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$tweetcode </span><span style="color: #007700">= </span><span style="color: #DD0000">""</span><span style="color: #007700">;<br />    </span><span style="color: #0000BB">drupal_add_js</span><span style="color: #007700">(</span><span style="color: #0000BB">$tweetcode</span><span style="color: #007700">,</span><span style="color: #DD0000">'inline'</span><span style="color: #007700">,</span><span style="color: #DD0000">'footer'</span><span style="color: #007700">);<br />    </span><span style="color: #0000BB">$block </span><span style="color: #007700">= array(<br />      </span><span style="color: #DD0000">'subject' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'Twitter'</span><span style="color: #007700">),<br />      </span><span style="color: #DD0000">'content' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"&lt;div id="</span><span style="color: #0000BB">twitter_div</span><span style="color: #DD0000">"&gt;&lt;ul id="</span><span style="color: #0000BB">twitter_update_list</span><span style="color: #DD0000">"&gt;&lt;li&gt;...loading...&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;"</span><span style="color: #007700">,<br />    );<br />    return </span><span style="color: #0000BB">$block</span><span style="color: #007700">; <br />  }<br />}<br /><br /><br />function </span><span style="color: #0000BB">tweetblock_footer</span><span style="color: #007700">(</span><span style="color: #0000BB">$main </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">) {<br />  </span><span style="color: #0000BB">$username </span><span style="color: #007700">= </span><span style="color: #0000BB">variable_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'tweetblock_username'</span><span style="color: #007700">, </span><span style="color: #DD0000">'mothersele'</span><span style="color: #007700">);<br />  </span><span style="color: #0000BB">$count </span><span style="color: #007700">= </span><span style="color: #0000BB">variable_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'tweetblock_count'</span><span style="color: #007700">, </span><span style="color: #0000BB">6</span><span style="color: #007700">);<br />  return </span><span style="color: #DD0000">"&lt;script type="</span><span style="color: #0000BB">text</span><span style="color: #007700">/</span><span style="color: #0000BB">javascript</span><span style="color: #DD0000">" src="</span><span style="color: #0000BB">http</span><span style="color: #007700">:</span><span style="color: #FF8000">//twitter.com/javascripts/blogger.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="http://twitter.com/statuses/user_timeline/{$username}.json?callback=twitterCallback2&amp;amp;count={$count}"&gt;&lt;/script&gt;";<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
<p>That's just two functions. The first defines a Drupal block called "Twitter" which will contain your recent twitter updates. It defines two new block settings, one for your twitter username, the other for the number of tweets to show.</p>
<p>The second function adds the Javascript call to the footer of your page. This means your page loads completely before the tweets are fetched. The javascript call requests your recent tweets from the twitter server and adds them to the block created by the first function.</p>



<div class="author-line">

  <figure class="author-image">
    <img src="/img/darren100.jpg" alt="Darren's Photo" class="avatar">
  </figure>

<h4>Darren Mothersele</h4>
<p>Darren is a software developer who builds simple, creative, and independent technology. <a href="/about">Read more &raquo;</a></p>
</div>




<footer>
  <p>Want to support my work? Buy my <a href="/blog/2016/06/16/php-framework-weekend/">PHP Framework</a> book.
  Available in paperback from <a href="http://amzn.to/2bNv560">Amazon</a> or eBook from <a href="https://leanpub.com/phpframework">Leanpub</a>.</p>
  <p>
    <small>
      &copy;2007-2017 <a href="/about">Darren Mothersele</a>.
        <a class="text-white" href="http://creativecommons.org/licenses/by-sa/4.0/">Some rights reserved</a>.
        <a href="/contact">Contact</a>.
        <a href="/blog/">Blog Archive</a>.
    </small>
  </p>
</footer>
</body>
</html>
