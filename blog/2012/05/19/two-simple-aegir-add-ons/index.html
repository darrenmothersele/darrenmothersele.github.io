<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>A couple of simple Aegir add-ons | Darren Mothersele</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>

<div class="home-logo">
  <a href="/">
<img src="/img/daz-logo.png" alt="Daz Logo" class="home-logo-img">
</a>
</div>

<hgroup class="alignCenter">
  <h1>A couple of simple Aegir add-ons</h1>
        <h6>May 19, 2012 Â· By Darren Mothersele</h6>
  <p class="sc">devops</p>
</hgroup>
<p>I'm using an Aegir based hosting system for Drupal sites, and I've needed to do a couple of configuration tasks on certain sites. Rather than just hack the configuration generated by Aegir, or hard code this in (and have to do the same each time I need it), I have put this in two simple modules. The first allows you to specify IP address that can access the site, the second applies some simple htaccess rules to harden up security. Get them from my GitHub, or read on for more details...</p>
<!--break-->
<h3><a href="https://github.com/darrenmothersele/hosting_firewall">Simple Hosting Firewall</a></h3>
<p>This is good for staging sites where you just want to restrict access to just developers, or clients who will approve the changes before they are pushed to the (live) production site. It means you dont have to expose your staging sites to the world.</p>
<p>It works by adding Apache conf rules to restrict by IP address. If you don't provide IP addresses then the whole world can see your site. If you provide a list of IP address then only clients with those IP addresses can access the site.  Grab the code <a href="https://github.com/darrenmothersele/hosting_firewall">from my GitHub account</a>.</p>
<p>NB: If you are using a reverse proxy cache, such as Varnish, in front of Drupal. Then you will need to have mod_rpaf installed in order for the correct IP address to be reported to Apache. On Ubuntu server you can install that mod like this:</p>
<p></p><div class="codeblock"><code>sudo apt-get install libapache2-mod-rpaf</code></div>
<h3><a href="https://github.com/darrenmothersele/aegir_secure_mods">Aegir Secure Mods</a></h3>
<p>This module adds some simple htaccess rewrite rules to harden up security a little. At the moment it just blocks access to the files left over from the Drupal installation process that are not required for a production site. </p>
<p>This module came about after a security agency performed penetration testing on a client's website and recommended that these files were removed. I decided, rather than remove them, to just rewrite them to a 404 error - making them look like they never existed! I prefer this approach because I'm building platforms from Drush make files and I don't want to keep removing the files each time, or have to roll a patch to remove them. </p>
<p>This module provides a simple checkbox on sites within Aegir to turn on the blocking of install files.  Grab the code from my <a href="https://github.com/darrenmothersele/aegir_secure_mods">GitHub account</a>.</p>
<h3>Installation</h3>
<p>Both modules need installing in your Aegir site same way you install any Drupal module. I recommend putting them in your aegir sites folder, (not the sites/all), so that when you upgrade Aegir using apt-get the modules are taken along with the site. </p>
<p>You also need to copy the provision script into your .drush folder, so that the Aegir backend can find it.</p>



<div class="author-line">

  <figure class="author-image">
    <img src="/img/darren100.jpg" alt="Darren's Photo" class="avatar">
  </figure>

<h4>Darren Mothersele</h4>
<p>Darren is a software developer who builds simple, creative, and independent technology. He believes this will empower humans to create a better future. <a href="/about">Read more &raquo;</a></p>
</div>


<div class="alignCenter">
  <p class="sc">Responses</p>
</div>
<p>I've removed the Disqus commenting system from my site
  to prevent your browsing activity being sent to a third party.
  No tracking is used on this site.
</p>
<p>Please bear with me while I implement a replacement
  (based on <a href="https://www.w3.org/TR/webmention/">Webmention</a>).
I will be porting over previous comments.
For now, if you want to comment, please
<a href="/contact">get in touch</a>.</p>



<footer>
  <p>
    <small>
      &copy;2007-2016 <a href="/about">Darren Mothersele</a>.
        <a class="text-white" href="http://creativecommons.org/licenses/by-sa/4.0/">Some rights reserved</a>.
        <a href="/contact">Contact</a>
    </small>
  </p>
</footer>
</body>
</html>
